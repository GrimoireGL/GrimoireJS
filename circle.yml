machine:
  node:
    version: 9.3.0
test:
  post:
    - sh release.sh
    - >-
      aws s3 cp ./coverage/ s3://coverage.grimoire.gl/core/$CIRCLE_BRANCH
      --recursive --region ap-northeast-1 --acl public-read
  override:
    - npm run lint && npm run build && npm run coverage
    - sh -x shell/e2e.sh
checkout:
  post:
    - git submodule init
    - git submodule update
deployment:
  deploy:
    branch: master
    commands:
      - npm run doc
      - >-
        aws s3 cp ./docs/ s3://api.grimoire.gl/core --recursive --region
        ap-northeast-1 --acl public-read
